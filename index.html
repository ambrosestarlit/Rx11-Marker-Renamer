<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markerï¼ŠRenamer - RX11ãƒãƒ¼ã‚«ãƒ¼åä¸€æ‹¬ç½®æ›ãƒ„ãƒ¼ãƒ«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Yu Gothic UI', 'MS Gothic', sans-serif;
            background: #e7d0a9;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(to right, #7c5b53, #a0795f);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .main-content {
            padding: 30px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .section-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .textarea-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        textarea {
            width: 100%;
            min-height: 250px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #7c5b53;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .primary-btn {
            background: #7c5b53;
            color: white;
        }

        .primary-btn:hover {
            background: #8b6a5b;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(124, 91, 83, 0.3);
        }

        .secondary-btn {
            background: #d4b89b;
            color: white;
        }

        .secondary-btn:hover {
            background: #c4a88b;
        }

        .success-btn {
            background: #6b8b5a;
            color: white;
        }

        .success-btn:hover {
            background: #5a7a49;
        }

        .warning-btn {
            background: #a87b5a;
            color: white;
        }

        .warning-btn:hover {
            background: #976a49;
        }

        .danger-btn {
            background: #b85a6b;
            color: white;
        }

        .danger-btn:hover {
            background: #a74959;
        }

        .output-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #c4a88b;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #7c5b53;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            animation: slideIn 0.3s;
            z-index: 1000;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.success {
            border-left: 4px solid #48c774;
        }

        .notification.warning {
            border-left: 4px solid #ff9f43;
        }

        .notification.error {
            border-left: 4px solid #ff6b6b;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            padding: 10px 20px;
            background: #7c5b53;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s;
        }

        .file-input-label:hover {
            background: #8b6a5b;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .grid-container {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
        }

        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            line-height: 1.5;
        }

        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>

    <div class="container">
        <div class="header">
            <h1>
                ğŸµ Markerï¼ŠRenamer
            </h1>
            <p>iZotope RX11ã®ãƒãƒ¼ã‚«ãƒ¼åã‚’ä¸€æ‹¬ã§ç½®æ›ã—ã¾ã™</p>
        </div>

        <div class="main-content">
            <div class="grid-container">
                <!-- å·¦å´: å…ƒã®ãƒãƒ¼ã‚«ãƒ¼ãƒ‡ãƒ¼ã‚¿ -->
                <div class="input-section">
                    <div class="section-title">
                        ğŸ“ å…ƒã®ãƒãƒ¼ã‚«ãƒ¼ãƒ‡ãƒ¼ã‚¿
                    </div>
                    <div class="textarea-container">
                        <textarea id="inputText" placeholder="ãƒãƒ¼ã‚«ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘ã‚‹ã‹ã€ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚

ä¾‹:
Marker file version: 1
Time format: Time
Marker 1	00:00:03.00000000		
Marker 2	00:00:07.00000000		
..."></textarea>
                        <div class="help-text">
                            RX11ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸãƒãƒ¼ã‚«ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« (.txt) ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¾ã™
                        </div>
                    </div>
                </div>

                <!-- å³å´: ç½®æ›ã™ã‚‹åå‰ãƒªã‚¹ãƒˆ -->
                <div class="input-section">
                    <div class="section-title">
                        âœï¸ ç½®æ›ã™ã‚‹åå‰ãƒªã‚¹ãƒˆ
                    </div>
                    <div class="textarea-container">
                        <textarea id="replacementNames" placeholder="ç½®æ›ã™ã‚‹åå‰ã‚’1è¡Œã«1ã¤ãšã¤å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

ä¾‹:
ã‚¤ãƒ³ãƒˆãƒ­
Aãƒ¡ãƒ­1
Bãƒ¡ãƒ­1
ã‚µãƒ“1
é–“å¥
..."></textarea>
                        <div class="help-text">
                            ãƒãƒ¼ã‚«ãƒ¼ã®å‡ºç¾é †ã«åå‰ãŒç½®æ›ã•ã‚Œã¾ã™ã€‚<br>
                            è¡Œæ•°ãŒãƒãƒ¼ã‚«ãƒ¼æ•°ã‚ˆã‚Šå°‘ãªã„å ´åˆã€æ®‹ã‚Šã®ãƒãƒ¼ã‚«ãƒ¼ã¯å¤‰æ›´ã•ã‚Œã¾ã›ã‚“ã€‚
                        </div>
                    </div>
                </div>
            </div>

            <!-- å‡¦ç†ãƒœã‚¿ãƒ³ -->
            <div class="button-group" style="justify-content: center; margin: 20px 0;">
                <div class="file-input-wrapper">
                    <input type="file" id="fileInput" accept=".txt">
                    <label for="fileInput" class="file-input-label" style="font-size: 16px; padding: 12px 30px;">
                        ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                    </label>
                </div>
                <button class="primary-btn" onclick="processMarkers()" style="font-size: 16px; padding: 12px 30px;">
                    âš¡ å‡¦ç†å®Ÿè¡Œ
                </button>
                <button class="danger-btn" onclick="clearAll()">
                    ğŸ—‘ï¸ ã™ã¹ã¦ã‚¯ãƒªã‚¢
                </button>
            </div>

            <div class="divider"></div>

            <!-- çµ±è¨ˆæƒ…å ± -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="inputMarkerCount">0</div>
                    <div class="stat-label">å…¥åŠ›ãƒãƒ¼ã‚«ãƒ¼æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="nameCount">0</div>
                    <div class="stat-label">ç½®æ›åæ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="processedCount">0</div>
                    <div class="stat-label">å‡¦ç†æ¸ˆã¿</div>
                </div>
            </div>

            <!-- å‡ºåŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="output-section">
                <div class="section-title">
                    ğŸ“¤ å‡ºåŠ›çµæœ
                </div>
                <textarea id="outputText" placeholder="å‡¦ç†çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™" style="min-height: 300px; margin-top: 10px;"></textarea>
                
                <div class="button-group" style="margin-top: 15px;">
                    <button class="success-btn" onclick="copyToClipboard()">
                        ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
                    </button>
                    <button class="warning-btn" onclick="downloadResult()">
                        ğŸ’¾ ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // åˆæœŸåŒ–æ™‚ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
        document.addEventListener('DOMContentLoaded', function() {
            // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å…¥åŠ›ç›£è¦–
            const inputTextArea = document.getElementById('inputText');
            const replacementNamesArea = document.getElementById('replacementNames');
            
            if (inputTextArea) {
                inputTextArea.addEventListener('input', updateStats);
            }
            
            if (replacementNamesArea) {
                replacementNamesArea.addEventListener('input', updateStats);
            }
            
            // ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
            const fileInput = document.getElementById('fileInput');
            if (fileInput) {
                fileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            document.getElementById('inputText').value = event.target.result;
                            updateStats();
                            showNotification('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'success');
                        };
                        reader.readAsText(file);
                    }
                });
            }
            
            // åˆæœŸåŒ–
            updateStats();
        });

        // çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°
        function updateStats() {
            const inputTextElement = document.getElementById('inputText');
            const replacementNamesElement = document.getElementById('replacementNames');
            
            if (!inputTextElement || !replacementNamesElement) {
                console.error('è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            const inputText = inputTextElement.value;
            const replacementNames = replacementNamesElement.value;
            
            // ãƒãƒ¼ã‚«ãƒ¼æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
            const markerCount = countMarkers(inputText);
            
            // ç½®æ›åæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆï¼ˆç©ºè¡Œã‚’é™¤å¤–ï¼‰
            let nameCount = 0;
            if (replacementNames && replacementNames.trim()) {
                const lines = replacementNames.split('\n');
                nameCount = lines.filter(line => line.trim().length > 0).length;
            }
            
            // è¡¨ç¤ºã‚’æ›´æ–°
            const markerCountElement = document.getElementById('inputMarkerCount');
            const nameCountElement = document.getElementById('nameCount');
            
            if (markerCountElement) {
                markerCountElement.textContent = markerCount;
            }
            
            if (nameCountElement) {
                nameCountElement.textContent = nameCount;
            }
        }

        // ãƒãƒ¼ã‚«ãƒ¼æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
        function countMarkers(text) {
            if (!text) return 0;
            
            // RX11ã®ãƒãƒ¼ã‚«ãƒ¼å½¢å¼ã«ãƒãƒƒãƒã™ã‚‹æ­£è¦è¡¨ç¾
            const markerPattern = /^Marker\s+\d+\s+\d{2}:\d{2}:\d{2}\.\d+/gm;
            const matches = text.match(markerPattern);
            return matches ? matches.length : 0;
        }

        // ãƒãƒ¼ã‚«ãƒ¼å‡¦ç†
        function processMarkers() {
            const inputText = document.getElementById('inputText').value;
            const replacementNames = document.getElementById('replacementNames').value;

            if (!inputText.trim()) {
                showNotification('å…ƒã®ãƒãƒ¼ã‚«ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'warning');
                return;
            }

            if (!replacementNames.trim()) {
                showNotification('ç½®æ›ã™ã‚‹åå‰ãƒªã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'warning');
                return;
            }

            // ç½®æ›åãƒªã‚¹ãƒˆã‚’é…åˆ—ã«å¤‰æ›ï¼ˆç©ºè¡Œã‚’é™¤å¤–ï¼‰
            const nameList = replacementNames.split('\n').filter(line => line.trim().length > 0);
            
            // å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡Œã”ã¨ã«å‡¦ç†
            const lines = inputText.split('\n');
            const result = [];
            let nameIndex = 0;
            
            // ãƒãƒ¼ã‚«ãƒ¼è¡Œã®ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆC#ç‰ˆã¨åŒã˜ï¼‰
            const markerPattern = /^(Marker\s+\d+)(\s+\d{2}:\d{2}:\d{2}\.\d+.*)$/;

            lines.forEach(line => {
                const match = line.match(markerPattern);
                if (match && nameIndex < nameList.length) {
                    // ãƒãƒ¼ã‚«ãƒ¼åã‚’ç½®æ›
                    result.push(nameList[nameIndex] + match[2]);
                    nameIndex++;
                } else {
                    // ãƒãƒ¼ã‚«ãƒ¼è¡Œã§ãªã„ã€ã¾ãŸã¯ç½®æ›åãŒè¶³ã‚Šãªã„å ´åˆã¯ãã®ã¾ã¾
                    result.push(line);
                }
            });

            // çµæœã‚’è¡¨ç¤º
            document.getElementById('outputText').value = result.join('\n');
            document.getElementById('processedCount').textContent = nameIndex;

            // çµæœã®é€šçŸ¥
            const totalMarkers = countMarkers(inputText);
            if (nameIndex === totalMarkers && totalMarkers > 0) {
                showNotification(`ã™ã¹ã¦ã®ãƒãƒ¼ã‚«ãƒ¼ï¼ˆ${nameIndex}å€‹ï¼‰ã‚’ç½®æ›ã—ã¾ã—ãŸ`, 'success');
            } else if (nameIndex < totalMarkers) {
                showNotification(`${nameIndex}å€‹ã®ãƒãƒ¼ã‚«ãƒ¼ã‚’ç½®æ›ã—ã¾ã—ãŸï¼ˆæ®‹ã‚Š${totalMarkers - nameIndex}å€‹ã¯å¤‰æ›´ãªã—ï¼‰`, 'warning');
            } else if (nameIndex > 0) {
                showNotification(`${nameIndex}å€‹ã®ãƒãƒ¼ã‚«ãƒ¼ã‚’ç½®æ›ã—ã¾ã—ãŸ`, 'success');
            } else {
                showNotification('ãƒãƒ¼ã‚«ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ', 'error');
            }
        }

        // ã‚¯ãƒªã‚¢
        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('replacementNames').value = '';
            document.getElementById('outputText').value = '';
            document.getElementById('processedCount').textContent = '0';
            updateStats();
            showNotification('ã™ã¹ã¦ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ', 'success');
        }

        // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
        function copyToClipboard() {
            const outputText = document.getElementById('outputText').value;
            if (!outputText) {
                showNotification('ã‚³ãƒ”ãƒ¼ã™ã‚‹å†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“', 'warning');
                return;
            }

            // ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã®Clipboard API
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(outputText)
                    .then(() => {
                        showNotification('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ', 'success');
                    })
                    .catch(() => {
                        fallbackCopyToClipboard(outputText);
                    });
            } else {
                fallbackCopyToClipboard(outputText);
            }
        }

        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼
        function fallbackCopyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                document.execCommand('copy');
                showNotification('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ', 'success');
            } catch (err) {
                showNotification('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            } finally {
                document.body.removeChild(textarea);
            }
        }

        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadResult() {
            const outputText = document.getElementById('outputText').value;
            if (!outputText) {
                showNotification('ä¿å­˜ã™ã‚‹å†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“', 'warning');
                return;
            }

            const now = new Date();
            const timestamp = now.getFullYear() + 
                              String(now.getMonth() + 1).padStart(2, '0') +
                              String(now.getDate()).padStart(2, '0') + '_' +
                              String(now.getHours()).padStart(2, '0') +
                              String(now.getMinutes()).padStart(2, '0') +
                              String(now.getSeconds()).padStart(2, '0');
            
            const filename = `RX11_Markers_${timestamp}.txt`;
            
            const blob = new Blob([outputText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification(`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¾ã—ãŸ: ${filename}`, 'success');
        }

        // é€šçŸ¥è¡¨ç¤º
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            if (notification) {
                notification.textContent = message;
                notification.className = `notification ${type}`;
                notification.style.display = 'block';
                
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
        }
    </script>
</body>
</html>
